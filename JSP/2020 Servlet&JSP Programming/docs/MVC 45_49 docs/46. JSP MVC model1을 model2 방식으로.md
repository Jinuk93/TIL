# 46. 📌JSP MVC model1을 model2 방식으로

# MVC Model 2 방식

## MVC Model 2 : 컨트롤러와 뷰가 물리적으로 분리된 방식

<aside>
😬 컨트롤러와 뷰가 물리적인 분리 여부에 따라 Model 1 , 2 의 가장 큰 차이라고 볼 수 있다

</aside>

- 일반적으로 분리된 상태에서 **한 가지 요소를 더한것을 Model 2 로 보면될 것이다**
- 그럼, 한 가지 요소는 무엇인가? **Dispatcher(디스패쳐)**

### Dispatcher(디스패쳐)란?

**컨트롤러(Controller)와 뷰(View)페이지를 연결함에 있어서 forwarding(포워딩)을 돕는 역할을 한다**

📌**컨트롤러는 디스패쳐를 통해서 뷰로 포워딩 한다**

→ 자세한 내용은 밑에서!

### 컨트롤러와 뷰의 연결방식 : forward

**보통 컨트롤러(Controller)는 Servlet, 뷰(View)는 JSP로 본다.**

**하지만, 뷰 또한 서블릿(Servlet)으로 봐도 무방하다.**

**Servlet에서 Servlet으로의 이전방식**

**즉, 컨트롤러와 뷰의 연결방식(이전방식)에서 forward 라는 개념이 있다**

---

### 컨트롤러(Controller)

![Untitled](https://user-images.githubusercontent.com/80089860/159260800-9eec3f96-0ae8-41e7-80ca-f1729a976c85.png)

### 뷰(View)단

![Untitled 1](https://user-images.githubusercontent.com/80089860/159260838-8cd399d3-f636-40aa-b080-f5b74a4e6fd0.png)

### Forward

아래 디스패쳐 설명에서 자세하게 다룬다

![Untitled 2](https://user-images.githubusercontent.com/80089860/159260858-8579478c-3852-4b83-a646-b37a5a139c6a.png)

📌**포워드와 리디렉트의 차이점과 포워딩 방법을 사용하는 이유를 알 수 있다!**

- **forward(포워드)는 현재 작업한 내용을 이어서 작업할 수 있도록, 공유를 한다**
- **redirect(리디렉트)는 현재 작업한 내용과 상관없이 새로운 내용을 요청한다**

---

### Dispatcher

![Untitled 3](https://user-images.githubusercontent.com/80089860/159260886-2199081d-cb1e-4d19-90e8-1beac9957c3d.png)

RequestDispatcher disapatcher = request.getRequestDispatcher(”model2.jsp”);

**괄호안에는  jsp 확장자를 넣어야 한다 → 컨트롤러(서블릿)에서 뷰(JSP)로 연결하는 방식(원리)**

밑의 사진 참조

---

![Untitled 4](https://user-images.githubusercontent.com/80089860/159260899-29eb4a79-7504-4ec5-87b2-0b762eff03a8.png)

이처럼 사용한다

### 상태를 저장할 때, 사용할 수 있는 저장소

1. **pageContext** : 뷰(페이지) 내에서 혼자 사용할 수 있는 페이지 컨텍스트 
    
                            하나의 서블릿 페이지(Servlet)에 대한 저장소
    
2. **ServletContext(전역 변수와 비슷한 느낌)** : 하나의 Web application에 대한 저장소
3. **Request** : forward 관계에서 사용되는 저장소
4. **Session** : 특정 Session에 대한 저장소
5. **Cookie** : Client에 저장하는 저장소
6. **Page** : 모든 페이지에서 사용되는 저장소

### request.setAttribute(”변수닉네임”, 변수);

**바로 위에서 저장소에 대해서 배웠는데,**

**여기서 쓰는 request 저장소가 ( forward 관계에서 사용되는 저장소 ) 이다.**

![Untitled 5](https://user-images.githubusercontent.com/80089860/159260930-9a60fd74-e8bc-451c-be3f-7c16ae6f8eef.png)

### 컨트롤러, 즉 서블릿 단에서 담아놓은 변수를

### 뷰, 즉 JSP단에서 꺼내서(이전받아) 사용하고 싶을때

### 위의 두 줄을 합한 내용을 “포워딩(forwarding)”이라고 한다

### 이 포워딩함에 있어서 사용되는 도구가 “디스패쳐(Dispatcher)”이다.

---

**그럼 위의 사진에서 r이란 이름으로 담아놓은 request 변수를 꺼내서 사용할 때를 알아보자!**

### JSP단에서 포워딩된 변수를 꺼내서 사용할 때

![Untitled 6](https://user-images.githubusercontent.com/80089860/159260955-9f8129e2-b859-4a43-9fc7-23f553f4a897.png)

![Untitled 7](https://user-images.githubusercontent.com/80089860/159260964-7acf354e-2ddd-474a-98da-3f1eb35718e2.png)

---

### SERVLET (컨트롤러) 에서의 디스패쳐를 통한 포워딩 코드작성 순서

![Untitled 8](https://user-images.githubusercontent.com/80089860/159260991-754a7415-e26a-4387-b680-8ff1aa191c89.png)

📌

**우선, 컨트롤러인 서블릿 단에서, 뷰 단인 JSP로 포워딩 함에 있어서의 코드 작성 순서를 알아보자**

1. **request.setAttribute(”변수닉네임”, 변수);  // servlet에서는 상자에 담을 변수를 set 한다**
2.  **RequestDispatcher dispatcher = request.getDispatcher(”model.jsp”);**

**// 디스패쳐를 통해 model.jsp와 연결함에 있어서 디스패쳐는 get 한다!**

**// 1번에서는 Atrribute를 set 하는것과는 다르게, dispatcher는 get 이니 헷갈리지 말도록 하자!**

1. **dispatcher.forward(reuqest.reponse); // dipatcher 안의 forward를 사용한다는 뜻인가?**

**// forward 함에 있어서 dispatcher는 무조건적인 듯 싶다**

### 📌📌파일을 실행할 때!!

<aside>
😬 파일을 실행함에 있어서 VIEW (JSP)단에서 실행하는 것이 아니라,                                         컨트롤러(서블릿)에서 실행!!!!

</aside>

![Untitled 9](https://user-images.githubusercontent.com/80089860/159261033-364e7b40-9d90-499a-87f2-be1d9b3d6e17.png)

---
# MVC Model2 정리

![Untitled 10](https://user-images.githubusercontent.com/80089860/159261056-e09fdca0-8e7b-47cc-8a3f-82e6c3442dac.png)

